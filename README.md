# Проект «YaMDb»

Проект YaMDb собирает отзывы пользователей на произведения. Сами произведения в YaMDb не хранятся, здесь нельзя посмотреть фильм или послушать музыку.
Произведения делятся на категории, такие как «Книги», «Фильмы», «Музыка». 
Благодарные или возмущённые пользователи могут оставить к произведениям текстовые отзывы и поставить произведению оценку в диапазоне от одного до десяти (целое число). 

## Технологии

* requests==2.26.0
* Django==3.2
* djangorestframework==3.12.4
* PyJWT==2.1.0
* pytest==6.2.4
* pytest-django==4.4.0
* pytest-pythonpath==0.7.3
* django-filter~=23.1

## Реализованы возможности
* Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.
* Произведению может быть присвоен жанр из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). 
* Добавлять произведения, категории и жанры может только администратор.
* Из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). 
* На одно произведение пользователь может оставить только один отзыв.
* Список категорий может быть расширен (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»). 



### Как запустить проект:

Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/khamaran/api_yamdb.git
```

```
cd api_yamdb
```

Cоздать и активировать виртуальное окружение:

```
python3 -m venv env
```

* Если у вас Linux/macOS

    ```
    source env/bin/activate
    ```

* Если у вас windows

    ```
    source env/scripts/activate
    ```

```
python3 -m pip install --upgrade pip
```

Установить зависимости из файла requirements.txt:

```
pip install -r requirements.txt
```

Выполнить миграции:

```
python3 manage.py migrate
```

Установить переменную окружения:

В директории проекта api_yamdb/api_yamdb создайте файл .env и запишите в него
полученную переменную в формате ключ=значение:

  ```python
  SECRET_KEY=abcdefgh123456789_etc
  ```

Файл .env должен лежать в той же директории, что и settings.py!

Запустить проект:

```
python3 manage.py runserver
```
## Документация

Когда вы запустите проект, по адресу  http://127.0.0.1:8000/redoc/ будет доступна документация для API YaMDb. 
В документации описано, как должен работать API. Документация представлена в формате Redoc.

## Заполнение базы данных контентом из приложенных csv-файлов

В директории /api_yamdb/static/data
подготовлены несколько файлов для тестирования проекта в формате csv с контентом для ресурсов Users, Titles, Categories, Genres, Reviews и Comments. 

Чтобы заполнить базу данных, выполните команду:

```
python3 manage.py load_csv
```

## Примеры запросов

### Получение списка всех категорий

**Получить список всех категорий Права доступа: Доступно без токена.**

*GET http://127.0.0.1:8000/api/v1/categories/*

*Пример ответа:*
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "name": "string",
      "slug": "string"
    }
  ]
}
```

### Добавление произведения

**Добавить новое произведение. Права доступа: Администратор. Нельзя добавлять произведения, которые еще не вышли (год выпуска не может быть больше текущего). 
При добавлении нового произведения требуется указать уже существующие категорию и жанр.**

*POST http://127.0.0.1:8000/api/v1/titles/*
```
{
  "name": "string",
  "year": 0,
  "description": "string",
  "genre": [
    "string"
  ],
  "category": "string"
}
```

*Пример ответа:*
```
{
  "id": 0,
  "name": "string",
  "year": 0,
  "rating": 0,
  "description": "string",
  "genre": [
    {
      "name": "string",
      "slug": "string"
    }
  ],
  "category": {
    "name": "string",
    "slug": "string"
  }
}
```
